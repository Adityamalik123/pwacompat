(function(){function f(a){if(navigator.standalone){var c;try{c=JSON.parse(window.localStorage["pwacompat.js"])}catch(d){}if(c){a(c);return}}var b=new XMLHttpRequest;b.onload=function(){var c=JSON.parse(b.responseText);try{window.localStorage["pwacompat.js"]=b.responseText}catch(k){}a(c)};b.open("GET",e.href);b.send()}function g(a){function c(a,b){if(b){var c=document.createElement("meta");c.setAttribute("name",a);c.setAttribute("content",!0===b?"yes":b);document.head.appendChild(c)}}var b=-1!==["standalone",
"fullscreen"].indexOf(a.display);c("apple-mobile-web-app-capable",b);c("mobile-web-app-capable",b);c("apple-mobile-web-app-title",a.short_name||a.name);c("msapplication-starturl",a.start_url||"/");c("msapplication-TileColor",a.theme_color);var d;(a.related_applications||[]).filter(function(a){return"itunes"==a.platform}).forEach(function(a){a.id?d=a.id:(a=a.url.match(/id(\d+)/))&&(d=a[1])});d&&c("apple-itunes-app","app-id="+d);b=a.icons||[];b.sort(function(a,b){return parseInt(b.sizes,10)-parseInt(a.sizes,
10)});b.forEach(function(a){var b=document.createElement("link");b.setAttribute("rel","apple-touch-icon");b.setAttribute("href",a.src);b.setAttribute("sizes",a.sizes);document.head.appendChild(b)});navigator.standalone&&h(a)}function h(a){document.addEventListener("click",function(a){"A"===a.target.tagName&&((new URL(a.target.href)).origin!==location.origin?window.localStorage["pwacompat.js:out"]=location.href:(a.preventDefault(),window.location=a.target.href))});if(!sessionStorage.loaded){sessionStorage.loaded=
!0;a=window.localStorage["pwacompat.js:out"]||a.start_url;delete window.localStorage["pwacompat.js:out"];var c=window.location.href+window.location.search;if(a&&a!=c)if(a.replace(/#.*$/,"")==c)window.location.hash=a.substr(a.indexOf("#"));else throw window.location=a,Error("stop, changed url");}}if(!navigator.serviceWorker&&window.localStorage){var e=document.head.querySelector('link[rel="manifest"]');e&&e.href?f(g):console.warn('pwacompat.js can\'t operate: no <link rel="manifest" ... /> found')}})();
