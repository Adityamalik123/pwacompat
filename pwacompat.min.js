(function(){function g(){var a=document.head.querySelector('link[rel="manifest"]'),b=a?a.href:"";Promise.resolve().then(function(){if(!b)throw'can\'t find <link rel="manifest" href=".." />\'';return window.fetch(b)}).then(function(a){return a.json()}).then(function(a){return n(a,b)}).catch(function(a){return console.warn("pwacompat.js error",a)})}function p(a,b){a=document.createElement(a);for(var c in b)a.setAttribute(c,b[c]);document.head.appendChild(a);return a}function h(a,b){b&&(!0===b&&(b="yes"),
p("meta",{name:a,content:b}))}function n(a,b){function c(c,b){var l=c.width;c=c.height;var d=window.devicePixelRatio,f=q({width:l*d,height:c*d});f.scale(d,d);f.fillStyle=a.background_color||"#f8f9fa";f.fillRect(0,0,l,c);f.translate(l/2,(c-32)/2);f.font="24px HelveticaNeue-CondensedBold";f.fillStyle=n?"white":"black";var e=a.name||a.short_name||document.title,h=f.measureText(e).width;if(b){var g=b.width/d;d=b.height/d;128<d&&(g/=d/128,d=128);48<=g&&48<=d&&(f.drawImage(b,g/-2,d/-2,g,d),f.translate(0,
d/2+32))}f.fillText(e,h/-2,0);b=document.createElement("link");b.setAttribute("rel","apple-touch-startup-image");b.setAttribute("media","(device-width: "+l+"px) and (device-height: "+c+"px)");b.setAttribute("href",f.canvas.toDataURL());return b}function e(){var a=c({width:window.screen.width,height:window.screen.height},r),b=c({width:window.screen.height,height:window.screen.width},r);document.head.appendChild(a);document.head.appendChild(b);t.forEach(function(a){return a.remove()});t.add(a);t.add(b)}
var k=a.icons||[];k.sort(function(a,b){return parseInt(b.sizes,10)-parseInt(a.sizes,10)});k.forEach(function(a){var c={rel:"icon",href:new URL(a.src,b),sizes:a.sizes};p("link",c);u&&(c.rel="apple-touch-icon",c=p("link",c),a.node=c)});var g=-1!==z.indexOf(a.display);h("mobile-web-app-capable",g);A&&(h("msapplication-starturl",a.start_url||"/"),h("msapplication-TileColor",a.theme_color));if(u){var n=v(a.background_color||"#f8f9fa"),B=v(a.theme_color||"black"),w=C(a.related_applications);w&&h("apple-itunes-app",
"app-id="+w);h("apple-mobile-web-app-status-bar-style",B?"default":"black");h("apple-mobile-web-app-capable",g);var r=null,t=new Set;e();window.addEventListener("resize",e);if(k.length){var x=k[0],m=new Image;m.onload=function(){r=m;e();if(a.background_color){var c=y(m,a.background_color);null!==c&&(x.node.href=c,k.slice(1).forEach(function(c){var b=new Image;b.onload=function(){var d=y(b,a.background_color,!0);c.node.href=d};b.src=c.node.href}))}};m.src=x.node.href}}}function C(a){var b;(a||[]).filter(function(a){return"itunes"===
a.platform}).forEach(function(a){a.id?b=a.id:(a=a.url.match(/id(\d+)/))&&(b=a[1])});return b}function v(a){var b=q();b.fillStyle=a;b.fillRect(0,0,1,1);a=b.getImageData(0,0,1,1).data.map(function(a){a/=255;return.03928>a?a/12.92:Math.pow((a+.055)/1.055,2.4)});return 3<Math.abs(1.05/(.2126*a[0]+.7152*a[1]+.0722*a[2]+.05))}function y(a,b,c){c=void 0===c?!1:c;var e=q(a);e.drawImage(a,0,0);if(!c&&255==e.getImageData(0,0,1,1).data[3])return null;e.globalCompositeOperation="destination-over";e.fillStyle=
b;e.fillRect(0,0,a.width,a.height);return e.canvas.toDataURL()}function q(a){a=void 0===a?{width:1,height:1}:a;var b=a.height,c=document.createElement("canvas");c.width=a.width;c.height=b;return c.getContext("2d")}if("fetch"in window){"complete"===document.readyState?g():window.addEventListener("load",g);var z=["standalone","fullscreen","minimal-ui"],u=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple"),A=navigator.userAgent&&-1!==navigator.userAgent.indexOf("Edge")}})();
