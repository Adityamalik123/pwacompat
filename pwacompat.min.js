(function(){function f(a){if(navigator.standalone){var b;try{b=JSON.parse(window.localStorage["pwacompat.js"])}catch(d){}if(b){a(b);return}}var c=new XMLHttpRequest;c.onload=function(){var b=JSON.parse(c.responseText);try{window.localStorage["pwacompat.js"]=c.responseText}catch(k){}a(b)};c.open("GET",e.href);c.send()}function g(a){function b(a,b){if(b){var c=document.createElement("meta");c.setAttribute("name",a);c.setAttribute("content",!0===b?"yes":b);document.head.appendChild(c)}}var c=-1!==["standalone",
"fullscreen"].indexOf(a.display);b("apple-mobile-web-app-capable",c);b("mobile-web-app-capable",c);b("apple-mobile-web-app-title",a.short_name||a.name);b("msapplication-starturl",a.start_url||"/");b("msapplication-TileColor",a.theme_color);b("theme-color",a.theme_color);var d;(a.related_applications||[]).filter(function(a){return"itunes"==a.platform}).forEach(function(a){a.id?d=a.id:(a=a.url.match(/id(\d+)/))&&(d=a[1])});d&&b("apple-itunes-app","app-id="+d);c=a.icons||[];c.sort(function(a,b){return parseInt(b.sizes,
10)-parseInt(a.sizes,10)});c.forEach(function(a){var b=document.createElement("link");b.setAttribute("rel","apple-touch-icon");b.setAttribute("href",a.src);b.setAttribute("sizes",a.sizes);document.head.appendChild(b)});navigator.standalone&&h(a)}function h(a){document.addEventListener("click",function(a){"A"===a.target.tagName&&((new URL(a.target.href)).origin!==location.origin?window.localStorage["pwacompat.js:out"]=location.href:(a.preventDefault(),window.location=a.target.href))});if(!sessionStorage.loaded){sessionStorage.loaded=
!0;a=window.localStorage["pwacompat.js:out"]||a.start_url;delete window.localStorage["pwacompat.js:out"];var b=window.location.href+window.location.search;if(a&&a!=b)if(a.replace(/#.*$/,"")==b)window.location.hash=a.substr(a.indexOf("#"));else throw window.location=a,Error("stop, changed url");}}if(!navigator.serviceWorker&&window.localStorage){var e=document.head.querySelector('link[rel="manifest"]');e&&e.href?f(g):console.warn('pwacompat.js can\'t operate: no <link rel="manifest" ... /> found')}})();
