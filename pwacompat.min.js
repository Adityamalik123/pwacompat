(function(){function k(){var a=document.head.querySelector('link[rel="manifest"]'),b=a?a.href:"";Promise.resolve().then(function(){if(!b)throw'can\'t find <link rel="manifest" href=".." />\'';return window.fetch(b)}).then(function(a){return a.json()}).then(function(a){return n(a,b)}).catch(function(a){return console.warn("pwacompat.js error",a)})}function p(a,b){a=document.createElement(a);for(var c in b)a.setAttribute(c,b[c]);document.head.appendChild(a);return a}function g(a,b){b&&(!0===b&&(b="yes"),
p("meta",{name:a,content:b}))}function n(a,b){function c(e,c,b){var h=e.width,d=e.height,f=window.devicePixelRatio;e=q({width:h*f,height:d*f});e.scale(f,f);e.fillStyle=a.background_color||"#f8f9fa";e.fillRect(0,0,h,d);e.translate(h/2,(d-32)/2);e.font="24px HelveticaNeue-CondensedBold";e.fillStyle=n?"white":"black";h=a.name||a.short_name||document.title;d=e.measureText(h).width;if(b){var g=b.width/f;f=b.height/f;128<f&&(g/=f/128,f=128);48<=g&&48<=f&&(e.drawImage(b,g/-2,f/-2,g,f),e.translate(0,f/2+
32))}e.fillText(h,d/-2,0);b=document.createElement("link");b.setAttribute("rel","apple-touch-startup-image");b.setAttribute("media","(orientation: "+c+")");b.setAttribute("href",e.canvas.toDataURL());return b}function d(a){var b=c(window.screen,"portrait",a);a=c({width:window.screen.height,height:window.screen.width},"landscape",a);r.forEach(function(a){return a.remove()});document.head.appendChild(b);document.head.appendChild(a);r.add(b);r.add(a)}var l=a.icons||[];l.sort(function(a,b){return parseInt(b.sizes,
10)-parseInt(a.sizes,10)});l.forEach(function(a){var c={rel:"icon",href:new URL(a.src,b),sizes:a.sizes};p("link",c);t&&(c.rel="apple-touch-icon",c=p("link",c),a.node=c)});var k=-1!==y.indexOf(a.display);g("mobile-web-app-capable",k);z&&(g("msapplication-starturl",a.start_url||"/"),g("msapplication-TileColor",a.theme_color));if(t){var n=u(a.background_color||"#f8f9fa"),A=u(a.theme_color||"black"),v=B(a.related_applications);v&&g("apple-itunes-app","app-id="+v);g("apple-mobile-web-app-status-bar-style",
A?"default":"black");g("apple-mobile-web-app-capable",k);var r=new Set;d();if(l.length){var w=l[0],m=new Image;m.onload=function(){d(m);if(a.background_color){var b=x(m,a.background_color);null!==b&&(w.node.href=b,l.slice(1).forEach(function(b){var c=new Image;c.onload=function(){var d=x(c,a.background_color,!0);b.node.href=d};c.src=b.node.href}))}};m.src=w.node.href}}}function B(a){var b;(a||[]).filter(function(a){return"itunes"===a.platform}).forEach(function(a){a.id?b=a.id:(a=a.url.match(/id(\d+)/))&&
(b=a[1])});return b}function u(a){var b=q();b.fillStyle=a;b.fillRect(0,0,1,1);a=b.getImageData(0,0,1,1).data.map(function(a){a/=255;return.03928>a?a/12.92:Math.pow((a+.055)/1.055,2.4)});return 3<Math.abs(1.05/(.2126*a[0]+.7152*a[1]+.0722*a[2]+.05))}function x(a,b,c){c=void 0===c?!1:c;var d=q(a);d.drawImage(a,0,0);if(!c&&255==d.getImageData(0,0,1,1).data[3])return null;d.globalCompositeOperation="destination-over";d.fillStyle=b;d.fillRect(0,0,a.width,a.height);return d.canvas.toDataURL()}function q(a){a=
void 0===a?{width:1,height:1}:a;var b=a.height,c=document.createElement("canvas");c.width=a.width;c.height=b;return c.getContext("2d")}if("fetch"in window){"complete"===document.readyState?k():window.addEventListener("load",k);var y=["standalone","fullscreen","minimal-ui"],t=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple"),z=navigator.userAgent&&-1!==navigator.userAgent.indexOf("Edge")}})();
